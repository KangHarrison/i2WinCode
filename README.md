# 📱 LAN-SMS-Forwarder (局域网短信验证码转发工具)

## 💡 项目简介

这是一个解决 **Windows 台式机 + iPhone** 用户痛点的实用小工具。本项目利用 iPhone 的**“快捷指令”自动化和 Python Flask 服务端，实现了在同一局域网（LAN）内，将收到的短信验证码安全、不经过公网**地实时转发到 Windows 台式机上。

用户无需拿起手机，即可在电脑上接收到验证码通知，并自动复制到剪贴板，极大提高了登录效率和安全性。

## ✨ 核心功能

  * **局域网传输：** 验证码数据在本地网络传输，**不依赖任何公共云服务**，保障隐私和安全。
  * **开箱即用：** 转发后，系统会弹出 **Windows 桌面通知**。
  * **自动复制：** 验证码被自动提取并复制到 Windows 剪贴板，用户只需按下 `Ctrl + V` 即可粘贴。
  * **静默运行：** Python 服务端可以配置为**开机自启并后台静默运行**，不占用桌面窗口。

-----

## ❓ 为什么不使用 Windows 手机连接 (Phone Link)？

对于 **Windows 台式机 + iPhone** 的组合，我们定制的局域网方案提供了更优越的体验和控制力：

1.  **无法自动复制：** Phone Link 对 iPhone 的支持主要依赖 **蓝牙通知**，它无法解析短信内容，因此**不支持自动提取验证码并复制到剪贴板**，用户仍需手动输入。
2.  **不依赖蓝牙：** 本方案基于稳定的 **Wi-Fi/LAN** 局域网连接，不需要台式机额外配置蓝牙适配器，避免了蓝牙连接不稳定的问题。
3.  **最高隐私保护：** 验证码数据**完全在您的局域网内传输**，没有经过任何第三方服务器或公网，提供了最高的安全性和隐私控制。

-----

## 🤝 其他设备组合推荐

如果您使用的是以下设备组合，**Microsoft 手机连接 (Phone Link)** 或系统自带功能可能会是更简单、更推荐的解决方案：

  * **Windows + Android 手机：** Phone Link 对 Android 提供了最完善的支持，包括同步完整的短信内容、查看照片、拨打电话等功能。
  * **macOS + iPhone：** Apple 自带的 **“接力 (Handoff)”** 功能可以完美实现短信验证码的自动识别和一键填充。

-----

## 🛠️ 环境要求

### 客户端 (iPhone)

  * 操作系统：iOS 13 或更高版本。
  * 应用：**“快捷指令” (Shortcuts)** App。

### 服务端 (Windows 台式机)

  * 操作系统：Windows 10 或 11。
  * 软件：**Python 3.x** 环境。
  * 网络：必须与 iPhone 连接在**同一个局域网（Wi-Fi 或有线）**内。

## ⚙️ 部署步骤

### 第一步：准备 Windows 服务端

1.  **克隆或下载项目**文件到您的 Windows 电脑上。
2.  **安装依赖库：** 打开命令行工具（CMD 或 PowerShell），进入项目目录，运行以下命令安装 Flask, Plyer (通知) 和 Pyperclip (剪贴板)：
    ```bash
    pip install flask plyer pyperclip
    ```
3.  **查找本地 IP：** 在命令行中输入 `ipconfig`，找到您的电脑在局域网中的 IPv4 地址（例如：`192.168.1.10`）。

### 第二步：运行并配置防火墙

1.  **运行服务端：** 运行 `sms_receiver.py` 文件。
    ```bash
    python sms_receiver.py
    ```
2.  **配置防火墙（关键步骤）：** 首次运行时，Windows 防火墙可能会拦截连接。您必须为 `python.exe` 进程添加入站规则，允许来自局域网的 **TCP 5000 端口**访问，否则 iPhone 将无法连接。

### 第三步：配置 iPhone 快捷指令

1.  **打开“快捷指令”** App，创建 **“新建个人自动化”**。
2.  **设置触发条件：**
      * 选择 **“收到信息”**。
      * 设置 **发件人** 为 `任何发件人`。
      * 设置 **包含** 关键词，例如：`验证码`, `Code`, `密码` 等。
3.  **关闭询问：** 确保将 **“运行前询问”** 开关关闭。
4.  **添加操作（获取 URL 内容）：**
      * **设置变量：** (可选，将“信息正文”保存为变量 `短信内容`)
      * **获取 URL 内容：**
          * **URL：** `http://[您的本地IP]:5000/sms_code` (替换您电脑的 IP 地址)
          * **方法：** `POST`
          * **请求主体：** `JSON` 格式，Key 为 `message`，Value 为之前设置的 `短信内容` 变量。

### 第四步：设置服务端后台运行（开机自启）

为实现开机自动且**无窗口**运行，这是最简单的方法：

1.**重命名文件**： 将您的主程序文件 sms_receiver.py **重命名**为 sms_receiver.pyw。Windows 会使用 pythonw.exe 来运行 .pyw 文件，该程序不会弹出命令行窗口。

2.**设置开机自启**：
+ 按下 Win + R 键，输入 shell:startup 并回车，打开 Windows **“启动”文件夹**。
+ 将 sms_receiver.pyw 文件（或其快捷方式）拖入此文件夹中。

## 📂 文件说明

  * **`sms_receiver.py`：** Python Flask 服务端主文件。负责接收数据、提取验证码、复制到剪贴板和发送 Windows 通知。